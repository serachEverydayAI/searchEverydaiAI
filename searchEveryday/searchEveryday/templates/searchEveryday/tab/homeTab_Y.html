{% load static %}
<style>
    .tabs {
        display: flex;
        /* justify-content: space-around; */
    }
    .tab {
        /* flex: 1; */
        min-width: 80px;
        text-align: center;
        padding: 10px 0px;
        cursor: pointer;
        position: relative;
        color: var(--gray);

        white-space: nowrap; /* 한 줄로 표시 */
        overflow: hidden; /* 넘치는 내용 숨김 */
        text-overflow: ellipsis; /* ... 표시 */
    }
    .tab.active {
        color: white;
        box-shadow: inset 0 -1.5px 0 var(--main-color);
    }

    .tab-content {
        display: none;
        padding: 0px 15px;
        max-height: calc(100vh - 120px);
        overflow-y: auto;
    }
    .tab-content.active {
        display: block;
    }
    .list-item {
        padding: 10px;
        margin: 5px 0;
        border: 1px solid #ccc;
        border-radius: 4px;
        height: 200px;
    }
    .tab_summary {
        margin: 12px 0px;
        font-size: small;
        color: var(--dark-main-color);
    }
    ::-webkit-scrollbar {
      display: none;
    }
    .icons {
        display: flex;
    }
</style>


<div class="parent-size flex_column">
    <div class="font-main-color">
        <div class="padding_bottom_little title_container ">
            <h5 style="margin:0px;" id="date">2024.01.01 (월)</h5>
            <div class="icons">
                <span class="material-icons icon_no_style">add_box</span>
                <span class="material-icons padding_side icon_no_style">calendar_today</span>
            </div>
        </div>


        <div class="tabs">
            <div class="tab active" data-tab="tab1" id="keyword1">키워드1</div>
            <div class="tab" data-tab="tab2" id="keyword2">키워드2</div>
            <div class="tab" data-tab="tab3" id="keyword3">키워드3</div>
        </div>

        <div class="tab-content active" id="tab1">

            <div class="tab_summary profile">
                <img class="bee_img" src="{% static 'image/icon/bee.png' %}"/>
                <span>
                    일주일 동안 324개 기사, 12개 주제로 정리해드렸어요.
                </span>
            </div>

            <div class="list-item" id="newsContainer">탭 1 아이템 1</div>
            <div class="list-item">탭 1 아이템 2</div>
            <div class="list-item">탭 1 아이템 3</div>
            <div class="list-item">탭 1 아이템 4</div>
            <div class="list-item">탭 1 아이템 5</div>
        </div>
        <div class="tab-content" id="tab2">

            <div class="tab_summary profile">
                <img class="bee_img" src="{% static 'image/icon/bee.png' %}"/>
                <span>
                    일주일 동안 34개 기사, 1개 주제로 정리해드렸어요.
                </span>
            </div>

            <div class="list-item">탭 2 아이템 1</div>
            <div class="list-item">탭 2 아이템 2</div>
            <div class="list-item">탭 2 아이템 3</div>
        </div>
        <div class="tab-content" id="tab3">

            <div class="tab_summary profile">
                <img class="bee_img" src="{% static 'image/icon/bee.png' %}"/>
                <span>
                    일주일 동안 1개 기사, 32개 주제로 정리해드렸어요.
                </span>
            </div>

            <div class="list-item">탭 3 아이템 1</div>
            <div class="list-item">탭 3 아이템 2</div>
            <div class="list-item">탭 3 아이템 3</div>
            <div class="list-item">탭 3 아이템 4</div>
            <div class="list-item">탭 3 아이템 5</div>
            <div class="list-item">탭 3 아이템 6</div>
            <div class="list-item">탭 3 아이템 7</div>
        </div>

    </div>
    <div id="toast" class="toast_color font-main-black-color toast ">
    </div>

</div>


<script>
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const activeTab = document.querySelector('.tab.active');
            const activeContent = document.querySelector('.tab-content.active');

            activeTab.classList.remove('active');
            activeContent.classList.remove('active');

            tab.classList.add('active');
            document.getElementById(tab.dataset.tab).classList.add('active');
        });
    });

    const cust_id = "{{ request.session.cust_id }}";

    $(document).ready(function() {
        const fetchData = (url, body) => {
            return fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrfToken,
                },
                body: JSON.stringify(body),
            }).then(response => {
                if (!response.ok) throw new Error('Network response was not ok.');
                return response.json();
            });
        };

        fetchData('/getMyKeyword/', { cust_id: cust_id })
            .then(data => {
                $('#keyword1').text(data.keyword1);
                $('#keyword2').text(data.keyword2);
                $('#keyword3').text(data.keyword3);
                const formattedDate = data.date.slice(0, 4) + '.' + data.date.slice(4, 6) + '.' + data.date.slice(6, 8);
                $('#date').text(formattedDate + " (" + data.korean_day + ")");
                return fetchData('/getTodayNewsList/', { cust_id: cust_id, day:data.date,
                 keyword1:data.keyword1 , keyword2:data.keyword2, keyword3:data.keyword3});
            })
            .then(newsData => {
                // $('#newsContainer').empty(); // 기존 뉴스 목록 초기화
                $('#newsContainer').text(newsData.title);
            })
            .catch(error => {
                console.error('Fetch error:', error);
            });
    });



</script>
